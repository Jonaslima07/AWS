<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>CRUD Lambda DynamoDB</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h2 { margin-top: 30px; }
        input, button { margin: 5px 0; padding: 5px; }
        .item { margin-bottom: 10px; }
        #itemsList { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>CRUD Lambda + DynamoDB</h1>

    <h2>Criar Item</h2>
    <form id="createForm">
        <input type="text" id="itemName" placeholder="Nome" required><br>
        <input type="number" id="itemPrice" placeholder="Preço" step="0.01" required><br>
        <button type="submit">Criar Item</button>
    </form>
    <p id="createMessage"></p>

    <h2>Buscar Item por ID</h2>
    <input type="text" id="searchId" placeholder="Digite o ID">
    <button onclick="getItemById()">Buscar</button>
    <div id="itemResult"></div>

    <h2>Todos os Itens</h2>
    <button onclick="getAllItems()">Carregar Itens</button>
    <div id="itemsList"></div>

    <script>
        const apiUrl = "https://SEU_API_ID.execute-api.sa-east-1.amazonaws.com";

        // Função para gerar UUID
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        // Criar item
        document.getElementById("createForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            const id = generateUUID();
            const name = document.getElementById("itemName").value;
            const price = parseFloat(document.getElementById("itemPrice").value);

            const response = await fetch(`${apiUrl}/items`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ id, name, price })
            });

            const data = await response.json();
            document.getElementById("createMessage").innerText = JSON.stringify(data);
            getAllItems();
        });

        // Buscar item por ID
        async function getItemById() {
            const id = document.getElementById("searchId").value;
            const response = await fetch(`${apiUrl}/items/${id}`);
            const data = await response.json();
            const resultDiv = document.getElementById("itemResult");
            resultDiv.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
        }

        // Buscar todos os itens
        async function getAllItems() {
            const response = await fetch(`${apiUrl}/items`);
            const data = await response.json();
            const itemsDiv = document.getElementById("itemsList");
            itemsDiv.innerHTML = data.map(item => `
                <div class="item">
                    <strong>ID:</strong> ${item.id} |
                    <strong>Nome:</strong> ${item.name} |
                    <strong>Preço:</strong> ${item.price.toFixed(2)}
                </div>
            `).join('');
        }
    </script>
</body>
</html>
